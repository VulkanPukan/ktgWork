@{
    ViewBag.Title = "Strength Tracker | Users";
    Layout = "~/Views/Admin/_LayoutNew.cshtml";

    var isSuperUser = false;
    if (Session["CustomerObj"] != null)
    {
        var customerObj = ((StrengthTracker2.Core.Repository.Entities.TKGMaster.CustomerMaster)(Session["CustomerObj"]));
        if (customerObj != null)
        {
            isSuperUser = customerObj.IsSuperAdmin;
        }
    }

    var isPersonalTrainer = false;
    if (Session["CustomerType"] != null)
    {
        var CustomerCategoryType = ((StrengthTracker2.Core.DataTypes.CustomerCategoryType)(Session["CustomerType"]));
        if (CustomerCategoryType == StrengthTracker2.Core.DataTypes.CustomerCategoryType.PersonalTrainer)
        {
            isPersonalTrainer = true;
        }
    }

    var canAddUser = false;
    var canEditUser = false;
    var canDeleteUser = false;
    if (Session["UserRole"] != null)
    {
        var userRole = (StrengthTracker2.Core.Repository.Entities.Security.RoleDetails)(Session["UserRole"]);
        var userPermissons = userRole.RolePermissions;
        canAddUser = userPermissons.Any(p => p.PermissionID == 7 && p.CanAdd == true);
        canEditUser = userPermissons.Any(p => p.PermissionID == 7 && p.CanEdit == true);
        canDeleteUser = userPermissons.Any(p => p.PermissionID == 7 && p.CanDelete == true);
    }
}
<style>
    .k-grid .k-alt {
        background-color: #f1f5fa; /* specify the alternate background-color */
    }

    .k-grid .k-grid-header .k-header .k-link {
        height: auto;
    }

    .k-grid .k-grid-header .k-header {
        white-space: normal;
    }

    #usersGrid .k-grid-content, #usersGrid tr td:last-child {
        overflow: visible;
    }

    #locationsGrid .k-grid-content, #locationsGrid tr td:last-child {
        overflow: visible;
    }

    #locationsGrid .k-grid-header {
        padding-right: 0 !important;
    }

    #usersGrid .k-grid-header {
        padding-right: 0 !important;
    }

    #dvSiteFooter {
        top: 70px !important;
    }

    .navbar-top .navbar-header {
        width: 250px !important;
        text-align: center;
    }

    td > a {
        color: #337ab7;
    }

        td > a:hover {
            color: #337ab7;
        }

    .custom-combobox {
        position: relative;
        display: inline-block;
    }

    .custom-combobox-toggle {
        position: absolute;
        top: 0;
        bottom: 0;
        margin-left: -1px;
        padding: 0;
    }

    .custom-combobox-input {
        margin: 0;
        padding: 5px 10px;
    }
    .custom-combobox{
        padding: 0px;
    }
    .ui-autocomplete-input {
        border-right: none !important;
        margin: 0px !important;
        top: 0px !important;
        padding: 0px !important;
        height: 32px !important;
        border: none !important;
        margin-left: 1px !important;
        padding-left: 8px !important;    
        width: calc(100% - 20px) !important; 
        background: #ffffff !important;    
    }
    .custom-combobox-toggle {
        padding-left: 4px;
        padding-top: 6px;
    }
</style>
<link rel="stylesheet" href="../content/kendo.common.min.css" />
<link rel="stylesheet" href="../content/kendo.silver.min.css">
<link rel="stylesheet" href="~/Scripts/jquery-ui-1.12.1/jquery-ui.theme.css">
<link rel="stylesheet" href="~/Scripts/jquery-ui-1.12.1/jquery-ui.css">

<div class="top-bar clearfix">
    <div class="container-fluid">
        <div class="row gutter">
            <div class="col-md-12 col-sm-6 col-xs-12">
                <h3 class="page-title" style="float:left;">Users</h3>
                <div id="userGridLegend" style="float: right; font-size: small; line-height: 20px; margin-top: 5px; margin-right: 18px;">
                    <div style="display: inline-flex">
                        <ul>
                            <li><i class="fa fa-circle" aria-hidden="true" style="color: green;"></i> Active</li>
                            <li><i class="fa fa-circle" aria-hidden="true" style="color: red;"></i> Inactive</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="main-container">
    <div class="row" id="userIconDiv" style="display:none;">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <input type="image" src="../images/noimage.jpg" width="80" height="80" id="profilePicture" />
            <input type="file" id="my_file" style="display: none;" />
        </div>
    </div>
    <div class="row gutter">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div id="usergridcontainer">
                <div class="clearfix">
                    <label style="text-decoration:underline;"></label>
                    @if (canAddUser)
                    {
                    <button type="button" onclick="AddUser();" class="btn btn-primary pull-right  mb-sm" style="margin-top: 50px;">
                        <em class="fa fa-plus-circle fa-fw mr-sm"></em>Add User
                    </button>
                    }
                    <div class="form-group">
                        <label class="control-label">Filter By Status</label>
                        <br>
                        <div class="input-group">
                            <select id="lstUserStatus" onchange="FilterChange();" name="Status" class="form-control" style="width: 200px;">
                                <option selected="selected" value="">All</option>
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="someplaceholderGrid" class="clearfix"></div>
            </div>
            <div id="usersGrid" style="margin-top:8px;"></div>
            <div id="userPager"></div>
            <div id="EditUsers" style="display:none;">
                <div class="">
                    <div class="panel-heading bb" style="float:right;font-weight:normal;display:inline-block;max-width:100%;margin-bottom:5px;color:white;">
                        Edit User
                        <div class="required pull-right" style="float:right;">* Required fields</div>
                    </div>
                    @using (Ajax.BeginForm("editAdminUserForm", "Admin", new AjaxOptions { HttpMethod = "POST", OnSuccess = "editUserResult" }, new { id = "editAdminUserForm" }))
                    {
                    <div class="panel-body">
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">First Name *</label>
                            <div class="col-lg-7">
                                <input type="text" data-requiredFld="true" id="txtEditUserFirstName" class="form-control" /><input type="hidden" id="hdUserID" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Last Name *</label>
                            <div class="col-lg-7">
                                <input type="text" data-requiredFld="true" id="txtEditUserLastName" class="form-control" /> <input type="hidden" id="hdContactID" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Username *</label>
                            <div class="col-lg-7">
                                <input data-requiredFld="true" type="text" id="txtEditUserName" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Email *</label>
                            <div class="col-lg-7">
                                <input type="text" data-requiredFld="true" id="txtEditUserEmail" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">DOB *</label>
                            <div class="col-lg-7">
                                <div id="userEditDatepicker" class="input-group date datetimepicker1">
                                    @Html.TextBox("txtEditDOB", "", new { @class = "form-control" })
                                    <span class="input-group-addon">
                                        <span class="fa-calendar fa"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Gender *</label>
                            <div class="col-lg-7">
                                <select name="Gender" id="rbtnEditGender" class="form-control m-b">
                                    <option>Male</option>
                                    <option>Female</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Address1 *</label>
                            <div class="col-lg-7">
                                <textarea id="txtEditAddress1" class="form-control"></textarea>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Address2</label>
                            <div class="col-lg-7">
                                <textarea id="txtEditAddress2" class="form-control"></textarea>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">City</label>
                            <div class="col-lg-7">
                                <input type="text" id="txtEditUserCity" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label>State</label>
                            <div class="col-lg-7">
                                <select name="state" class="form-control m-b state-select" id="ddlAthleteState">
                                    <option>Select State</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Zip</label>
                            <div class="col-lg-7">
                                <input type="text" id="txtEditUserZip" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Password *</label>
                            <div class="col-lg-7">
                                <input data-requiredFld="true" type="password" id="txtEditUserPassword" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-6">
                            <label class="col-lg-5 control-label">Confirm Password *</label>
                            <div class="col-lg-7">
                                <input data-requiredFld="true" type="password" id="txtEditUserConfirmPassword" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group col-lg-12" style="width:96% !important;" id="locationRoleAdd">
                            Location - Role Configuration @*style="display:none;">*@
                            <button type="button" onclick="ShowAddEditLocation();" class="btn btn-primary pull-right  mb-sm">
                                <em class="fa fa-plus-circle fa-fw mr-sm"></em>Add Location
                            </button>
                        </div>
                        <div class="form-group col-lg-12" style="display:none;">
                            <div class="col-lg-12">
                                <div id="locationsGrid" style="margin-top:15px; margin-left:85px !important; width: 87% !important; overflow:visible !important;" class="clearfix"></div>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">&nbsp;</div>
                        <div class="form-group col-lg-12" style="width:98.5% !important;">
                            <div class="col-lg-5">&nbsp;</div>
                            <div class="pull-right">
                                <button type="button" id="btnCancelEditUser" onclick="ShowUserGrid();" class="btn btn-sm btn-default">Cancel</button>
                                <button type="button" id="btnSaveEditUser" value="Ok" class="btn btn-primary btn-sm" onclick="SaveAdminUser();">Save1</button>
                            </div>
                        </div>
                    </div>
                    }
                </div>
            </div>
            <div id="AddUsers" style="display:none;">
                @using (Ajax.BeginForm("addAdminUserForm", "Admin", new AjaxOptions { HttpMethod = "POST", OnSuccess = "addUserResult" }, new { id = "addAdminUserForm" }))
                {
                    <div class="">
                        <div class="panel-heading bb" style="font-weight:normal;color:white;">
                            <span id="spnUser">Add User</span>
                            <div class="required usersGrid-right" style="float:right;">* Required fields</div>
                        </div>
                        <div class="panel-body">
                            <div id="dvAddAdminUserMsg" style="display:none;"></div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">First Name *</label>
                                <div class="col-lg-7">
                                    <input type="text" data-requiredFld="true" id="txtAddUserFirstName" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Last Name *</label>
                                <div class="col-lg-7">
                                    <input type="text" data-requiredFld="true" id="txtAddUserLastName" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Username *</label>
                                <div class="col-lg-7">
                                    <input data-requiredFld="true" type="text" id="txtAddUserName" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Email *</label>
                                <div class="col-lg-7">
                                    <input type="email" data-requiredFld="true" id="txtAddUserEmail" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">DOB</label>
                                <div class="col-lg-7">
                                    <div id="userAddDatepicker" class="input-group date datetimepicker1">
                                        @Html.TextBox("txtAddDOB", "", new { @class = "form-control" })
                                        <span class="input-group-addon">
                                            <span class="fa-calendar fa"></span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Gender</label>
                                <div class="col-lg-7">
                                    <select name="Gender" id="lstGender" class="form-control m-b">
                                        <option value="">Select gender</option>
                                        <option value="1">Male</option>
                                        <option value="2">Female</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Address1 *</label>
                                <div class="col-lg-7">
                                    <textarea id="txtAddAddress1" class="form-control"></textarea>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Address2</label>
                                <div class="col-lg-7">
                                    <textarea id="txtAddAddress2" class="form-control"></textarea>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">City</label>
                                <div class="col-lg-7">
                                    <input type="text" id="txtAddUserCity" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">State</label>
                                <div class="col-lg-7">
                                    @Html.DropDownList("ddlState", new System.Web.Mvc.SelectList(ViewBag.StateList, "Value", "Text"), new { @class = "form-control m-b" })
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Country</label>
                                <div class="col-lg-7">
                                    <select name="state" class="form-control m-b country-select" id="ddlCountry">
                                        <option>Select Country</option>
                                        @*<option value="3">Belgium</option>
                                        <option value="2">Canada</option>
                                        <option value="4">France</option>
                                        <option value="5">Germany</option>
                                        <option value="6">UK</option>
                                        <option value="1">US</option>*@
                                    </select>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Zip Code</label>
                                <div class="col-lg-7">
                                    <input type="text" id="txtAddUserZip" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Password *</label>
                                <div class="col-lg-7">
                                    <input data-requiredFld="true" type="password" id="txtAddUserPassword" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label class="col-lg-5 control-label">Confirm Password *</label>
                                <div class="col-lg-7">
                                    <input data-requiredFld="true" type="password" id="txtAddUserConfirmPassword" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-12" style="display:none;">
                                <label class="col-lg-4 control-label" style="width:18% !important;">Role(s)</label>
                            </div>
                            <div id="divCoachRoleDetailsAdd" style="display:none;">
                                <div class="form-group col-lg-12">
                                    <label class="col-lg-4 control-label" style="width:18% !important;">Sport(s)</label>
                                    <div class="col-lg-8" style="width:79% !important;">
                                        <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Baseball</label></div>
                                        <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Boxing</label></div>
                                        <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Cycling</label></div>
                                        <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Fencing</label></div>
                                        <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Football</label></div>
                                    </div>
                                </div>
                                <div class="form-group col-lg-12">
                                    @*<label class="col-lg-4 control-label" style="width:20% !important;"></label>*@
                                    <div class="col-lg-12">
                                        <div id="coachAthleteGridAdd" style="margin-top:15px; margin-left:85px !important; width: 87% !important; overflow:visible !important;" class="clearfix"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">&nbsp;</div>
                            <div class="form-group col-lg-12">
                                <div class="col-lg-7 pull-right">
                                    <div class="pull-right">
                                        @*<button type="button" id="btnCancelAddUser" onclick="ShowUserGrid();" class="btn btn-sm btn-danger">Cancel</button>*@
                                        @if (canEditUser)
                                        {
                                            <button type="button" id="btnSaveAddUser" value="Ok" class="btn btn-success mb-lg" onclick="SaveAddUser();">Save</button>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-lg-6">&nbsp;</div>

                            <div class="form-group col-lg-6">&nbsp;</div>

                            <br />
                            <div class="form-group col-lg-12" style="display:none;">
                                <div class="col-lg-7 pull-right">
                                    <div class="pull-right">
                                        <button type="button" onclick="ShowAddUserLocationRole();" class="btn btn-default pull-right  mb-sm">
                                            <em class="fa fa-plus-circle fa-fw mr-sm"></em>Add Role
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @if (isPersonalTrainer == false)
                        {
                            <div id="dvRole">
                                <div>
                                    <div class="panel-heading bb" style="font-weight:normal;color:white;">
                                        Role
                                    </div>
                                    <div class="panel-body">
                                            <div class="form-group col-lg-6">
                                                <label class="col-lg-5 control-label">Role</label>
                                                <div class="col-lg-7">
                                                    @Html.DropDownList("lstRole", new System.Web.Mvc.SelectList(ViewBag.RoleList, "RoleID", "RoleName"), new { @class = "form-control combobox" })
                                                </div>
                                            </div>
                                            <div class="form-group col-lg-12">
                                                Note: Roles and Created, Edited, and Viewed in Roles tab. A Role is created to determine which parts of StrengthTracker someone with that
                                                Role has access to. Essentially, this means which Modules (tabs) they are authorized to select and whether they can View, Edit, Create and/or Delete
                                                information within that Module (tab).
                                            </div>
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-7 pull-right">
                                                <div class="pull-right">
                                                    <input type="button" id="btnAddRole" value="Save" class="btn btn-success mb-lg" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @Html.Partial("UserDataVisibility")
                        }
                        else
                        {
                            @Html.Partial("PersonalTrainerProfileSection")
                        }
                    </div>
                }
            </div>
            <div id="locationAddEdit" style="width:100% !important;display:none;">
                <div>
                    <div class="panel-heading bb" style="font-weight:normal;color:white;">
                        Role
                    </div>
                    <div class="panel-body" style="width: 100% !important;">
                        <div class="form-group col-lg-12" style="width:100% !important;">
                            <div class="col-lg-12">
                                <div id="locationsGrid" style="margin-top:15px; width: 100% !important; overflow:visible !important;" class="clearfix"></div>
                            </div>
                        </div>
                        <div id="divLocationRole" style="width: 100%;">
                            <div class="form-group col-lg-12" style="width:100%;display:none;">
                                <label class="col-lg-6 control-label" style="text-align:left;width:25% !important;">Location</label>
                                <div class="col-lg-6 pull-right mb-sm" style="width:75% !important;text-align:right;">
                                    @Html.DropDownList("lstLocation", new System.Web.Mvc.SelectList(ViewBag.LocationList, "ID", "LocationName"), new { @class = "form-control m-b" })
                                </div>
                            </div>
                            <div class="form-group col-lg-12" style="width: 100%;">
                                <label class="col-lg-4 control-label" style="text-align:left;width:25% !important;">Role</label>
                                <div class="col-lg-8" style="width:75% !important;float:left;margin-left:-20px;">
                                    @Html.DropDownList("lstRole", new System.Web.Mvc.SelectList(ViewBag.RoleList, "RoleID", "RoleName"), new { @class = "form-control m-b" })

                                    @*@foreach (var item in ViewBag.RoleList)
                                        {
                                        <div class="checkbox checkbox-inline c-checkbox" style="text-align:left;">
                                            <label style="text-align:left;">
                                                <input type="checkbox" value=@item.RoleID name="RoleName" id="chkRoleName">
                                                <span class="fa fa-check"></span>@item.RoleName
                                            </label>
                                        </div>
                                        }*@
                                </div>
                                <div class="form-group col-lg-6">&nbsp;</div>
                            </div>
                            <div class="form-group col-lg-12">
                                <div class="col-lg-7 pull-right">
                                    <div class="pull-right">
                                        <button type="button" id="btnSaveLocationRole" value="Ok" class="btn btn-success pull-right mb-lg">Save</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="divCoachRoleDetailsEdit" style="display:none;">
                            <div class="form-group col-lg-12">
                                <label class="col-lg-4 control-label" style="width:18% !important;">Sport(s)</label>
                                <div class="col-lg-8" style="width:79% !important;">
                                    <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Baseball</label></div>
                                    <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Boxing</label></div>
                                    <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Cycling</label></div>
                                    <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Fencing</label></div>
                                    <div class="checkbox checkbox-inline c-checkbox"><label><input type="checkbox" value=""><span class="fa fa-check"></span>Football</label></div>
                                </div>
                            </div>
                            <div class="form-group col-lg-12">
                                <div class="col-lg-12">
                                    <div id="coachAthleteGridEdit" style="margin-top:15px; margin-left:85px !important; width: 87% !important; overflow:visible !important;" class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-lg-6">&nbsp;</div>
                        <div class="form-group col-lg-12" style="width:96% !important;display:none;">
                            <div class="col-lg-7 pull-right">
                                <div class="pull-right">
                                    <button type="button" onclick="ShowEditUser();" class="btn btn-sm btn-danger">Cancel</button>
                                    @if (canEditUser)
                                    {
                                        <button type="button" onclick="ShowEditUser();" class="btn btn-success btn-sm">Save</button>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="confirmDeletion" tabindex="-1" role="dialog" aria-labelledby="confirmDeletionLabel" aria-hidden="true" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                <h4 id="confirmDeletionLabel" class="modal-title">Confirm Deletion</h4>
            </div>
            <div class="modal-body" style="margin-left:16px;">
                <form>
                    <div class="form-group">
                        <span>Delete user?</span>
                        <input type="hidden" id="hdDelProgramID" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-success">Cancel</button>
                <button type="button" class="btn btn-danger" onclick="Delete();">Delete</button>
            </div>
        </div>
    </div>
</div>
<div id="confirmDeletionLocation" tabindex="-1" role="dialog" aria-labelledby="confirmDeletionLocationLabel" aria-hidden="true" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                <h4 id="confirmDeletionLabel" class="modal-title">Confirm Deletion</h4>
            </div>
            <div class="modal-body" style="margin-left:16px;">
                <form>
                    <div class="form-group">
                        <span>Delete Location?</span>
                        <input type="hidden" id="hdDelLocationID" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-success">Cancel</button>
                <button type="button" class="btn btn-danger" onclick="DeleteCustomerLocatonRoles();">Delete</button>
            </div>
        </div>
    </div>
</div>
<div id="confirmActivation" tabindex="-1" role="dialog" aria-labelledby="confirmActivationLabel" aria-hidden="true" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                <h4 id="confirmActivationLabel" class="modal-title">Confirm Updation</h4>
            </div>
            <div class="modal-body">
                Update user status?
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-default">Cancel</button>
                <button type="button" class="btn btn-primary">Update</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="adminUserMsgModal" style="display:none;width:500px !important;height:150px !important;top: 30% !important; left: 75% !important;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"></span></button>
                <h4 class="modal-title">Admin User</h4>
            </div>
            <div class="modal-body">
                <table style="width: 100%">
                    <tr>
                        <td>
                            <div style="margin-left:110px;" id="dvModalAdminUserMsg"></div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="modalPopupOK" onclick="CloseAdminUserMsgPopup();" style="margin-top:8px;margin-left:165px !important;">OK</button>
        </div>
    </div>
</div>

<!-- START AD Tooltip modal-->
<div id="ADTooltipModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteLabel" aria-hidden="true" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                <h4 id="adToolTipModalLabel" class="modal-title">Information</h4>
            </div>
            <div class="modal-body">
                <div>Clicking here gives this user access to all data associated with all coaches, all sports, all teams similar to an Athletic Director.</div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-default">Cancel</button>
                @*                <input type="button" class="btn btn-primary" value="Delete"/>*@
            </div>
        </div>
    </div>
</div>
<!-- END AD Tooltip modal-->
<!-- START SC Tooltip modal-->
<div id="SCTooltipModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteLabel" aria-hidden="true" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                <h4 id="scToolTipModalLabel" class="modal-title">Information</h4>
            </div>
            <div class="modal-body">
                <div>User can see athletes for all the sports and all the teams. User only has access to own data</div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-default">Cancel</button>
                @*                <input type="button" class="btn btn-primary" value="Delete"/>*@
            </div>
        </div>
    </div>
</div>
<!-- END AD Tooltip modal-->
@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryui")
    <script src="../Scripts/kendo.all.min.js"></script>
    <script src="~/Scripts/StrengthTracker2/UserDataVisibility.js"></script>
    <script src="~/Scripts/StrengthTracker2/Common.js"></script>
    <script src="~/Scripts/moment/min/moment.min.js"></script>
    <script src="~/Scripts/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Scripts/StrengthTracker2/User.js"></script>
    <script src="~/Scripts/jquery.maskedinput.js">
    </script>
    <script type="text/javascript" charset="utf-8">
        $(function () {
            $('.datetimepicker1').datetimepicker({
                disabledHours: true,
                format: 'MM/DD/YYYY'
            });

            $("#customerPhone").mask("(999) 999-9999");
            $('#txtAddUserZip').mask("99999");
            $("#liUser").addClass("active");
            $("#liUsers").addClass("active");
        });

        if (!window.UserPermissions) {
            window.UserPermissions = {};
        }
        @if (canAddUser)
        {
            @:window.UserPermissions.CanAddUser = true;
                                }
        @if (canEditUser)
        {
            @:window.UserPermissions.CanEditUser = true;
                                }
        @if (canDeleteUser)
        {
            @:window.UserPermissions.CanDeleteUser = true;
                                }

        function AddUser() {
            window.location = "@Url.Action("ManageUsers", "Admin")";
        }

        var locdataSource = new kendo.data.DataSource({
            data: [],
            pageSize: 10
        });
        var coachathletesdataSource = new kendo.data.DataSource({
            data: [
                { AthleteName: "John Dear", Selected: true, DOB: "10/1/2000", Sports: "Basketball", Position: "Shooting Guard" },
                { AthleteName: "Trendo las", Selected: true, DOB: "7/8/2001", Sports: "Basketball", Position: "Power Forward" },
                { AthleteName: "Markel ", Selected: true, DOB: "2/21/2000", Sports: "Baseball", Position: "Pitcher" },
                { AthleteName: "Macheal Shain", Selected: true, DOB: "4/6/1999", Sports: "Baseball", Position: "Short Stop" },
                { AthleteName: "Arunasen", Selected: true, DOB: "10/8/2004", Sports: "Cricket", Position: "Wicket Keeper" },
                { AthleteName: "Coawn Goael", Selected: false, DOB: "12/28/2003", Sports: "Soccer", Position: "Full Back" },
                { AthleteName: "John Rine", Selected: true, DOB: "20/3/2016", Sports: "Soccer", Position: "Forward" },
                { AthleteName: "Nichel Ren", Selected: false, DOB: "10/6/2016", Sports: "Soccer", Position: "Midfielder" },
            ],
            pageSize: 10
        });
        var locationsdataSource = new kendo.data.DataSource({
            data: [
                { Location: "Washington", Roles: "TKG Admin, Coach", Sports: "Basketball, Pitcher" }
            ],
            pageSize: 10
        });

        userdataSource.read();
        locdataSource.read();

        $("#my_file").change(function () {
            var reader = new FileReader();
            reader.onload = function (e) {
                document.getElementById("profilePicture").src = e.target.result;
            };
            if (this.files[0]) {
                reader.readAsDataURL(this.files[0]);
            }
        });

        $("#profilePicture").click(function () {
            $("input[id='my_file']").click();
        });
        function dateTimeEditor(container, options) {
            $('<input data-text-field="' + options.field + '" data-value-field="' + options.field + '" data-bind="value:' + options.field + '" data-format="' + options.format + '"/>')
                .appendTo(container)
                .kendoDatePicker({});
        }

        @if (isPersonalTrainer)
        {
            @:GetUserDetails(@Session["AuthenticatedUserId"]);
                                    @:InitPersonalTrainerProfileSections();
                                }
        var qryUSerID = getUrlVars()["id"];
        if (qryUSerID != undefined || qryUSerID != null) {
            GetUserDetails(qryUSerID);
        }
        var initAutoSuggestCombobox = function () {
            $.widget("custom.combobox", {
                _create: function () {
                    this.wrapper = $("<span>")
                        .addClass("custom-combobox  form-control")
                        .insertAfter(this.element);

                    this.element.hide();
                    this._createAutocomplete();
                    this._createShowAllButton();
                },
                _createAutocomplete: function () {
                    var selected = this.element.children(":selected"),
                        value = selected.val() ? selected.text() : "";

                    this.input = $("<input>")
                        .appendTo(this.wrapper)
                        .val(value)
                        .attr("title", "")
                        .addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left")
                        .autocomplete({
                            delay: 0,
                            minLength: 0,
                            source: $.proxy(this, "_source")
                        })
                        .tooltip({
                            classes: {
                                "ui-tooltip": "ui-state-highlight"
                            }
                        });

                    this._on(this.input, {
                        autocompleteselect: function (event, ui) {
                            ui.item.option.selected = true;
                            this._trigger("select", event, {
                                item: ui.item.option
                            });
                        },

                        autocompletechange: "_removeIfInvalid"
                    });
                },
                _createShowAllButton: function () {
                    var wasOpen = false;
                    var input = this.input;

                    $("<a>")
                        .attr("tabIndex", -1)
                        .attr("title", "Show All Items")
                        .addClass("custom-combobox-toggle ui-corner-right")
                        .tooltip()
                        .appendTo(this.wrapper)
                        //.button({
                        //    icons: {
                        //        primary: "ui-icon-triangle-1-s"
                        //    },
                        //    text: false
                        //})
                        .append('<span class="ui-button-icon ui-icon ui-icon-triangle-1-s"></span>')
                        .removeClass("ui-corner-all")
                      
                        .on("mousedown", function () {
                            wasOpen = input.autocomplete("widget").is(":visible");
                        })
                        .on("click", function () {
                            input.trigger("focus");

                            // Close if already visible
                            if (wasOpen) {
                                return;
                            }

                            // Pass empty string as value to search for, displaying all results
                            input.autocomplete("search", "");
                        });

                },
                _source: function (request, response) {
                    var matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), "i");
                    response(this.element.children("option").map(function () {
                        var text = $(this).text();
                        if (this.value && (!request.term || matcher.test(text)))
                            return {
                                label: text,
                                value: text,
                                option: this
                            };
                    }));
                },
                _removeIfInvalid: function (event, ui) {

                    // Selected an item, nothing to do
                    if (ui.item) {
                        return;
                    }

                    // Search for a match (case-insensitive)
                    var value = this.input.val(),
                        valueLowerCase = value.toLowerCase(),
                        valid = false;
                    this.element.children("option").each(function () {
                        if ($(this).text().toLowerCase() === valueLowerCase) {
                            this.selected = valid = true;
                            return false;
                        }
                    });

                    // Found a match, nothing to do
                    if (valid) {
                        return;
                    }

                    // Remove invalid value
                    this.input
                        .val("")
                        .attr("title", value + " didn't match any item")
                        .tooltip("open");
                    this.element.val("");
                    this._delay(function () {
                        this.input.tooltip("close").attr("title", "");
                    }, 2500);
                    this.input.autocomplete("instance").term = "";
                },
                _destroy: function () {
                    this.wrapper.remove();
                    this.element.show();
                }
            });

            $(".combobox").combobox();
        };

        function FilterChange() {
            var filters = [];

            // status filter
            // we remember that the <select> element has string type of value?
            if ($("#lstUserStatus").val() === 'true')
                filters.push({ field: "IsActive", operator: "eq", value: true });
            else if ($("#lstUserStatus").val() === 'false')
                filters.push({ field: "IsActive", operator: "eq", value: false });

            userdataSource.filter({
                logic: "and",
                filters: filters
            });

            $("#usersGrid").data("kendoGrid").setDataSource(userdataSource);
            $('#usersGrid').data('kendoGrid').refresh();
        }
    </script>
}
